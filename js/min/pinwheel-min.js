!function($){var e=jQuery.event,t,i;t=e.special.debouncedresize={setup:function(){jQuery(this).on("resize",t.handler)},teardown:function(){jQuery(this).off("resize",t.handler)},handler:function(a,n){var r=this,s=arguments,l=function(){a.type="debouncedresize",e.dispatch.apply(r,s)};i&&clearTimeout(i),n?l():i=setTimeout(l,t.threshold)},threshold:50},$.fn.pinwheel=function(e){if(this.length>1)return this.each(function(){$(this).pinwheel(e)}),this;e=$.extend({},$.fn.pinwheel.defaults,e||{});var t,i;t=0==e.sliderMaxWidth?$(this).width():e.sliderMaxWidth,i=0==e.sliderMaxHeight?$(this).height():e.sliderMaxHeight;var a={currentCenterNum:e.startingFeature,prevCenterNum:-1,containerWidth:0,containerHeight:0,largeFeatureWidth:0,largeFeatureHeight:0,smallFeatureWidth:0,smallFeatureHeight:0,totalFeatureCount:$(this).children("div").length,allItems:$(this).children("div"),currentlyMoving:!1,featuresContainer:$(this),featuresArray:[],containerIDTag:"#"+$(this).attr("id"),timeoutVar:null,rotationsRemaining:0,itemsToAnimate:0,borderWidth:0,sliderMaxWidth:t,sliderMaxHeight:i},n=function(t){if(1==e.preload){var i=a.featuresContainer.find("img"),n=0,r=i.length;i.each(function(e,i){var a=new Image;$(a).bind("load error",function(){n++,n==r&&t()}),a.src=i.src})}else t()},r=function(e){return a.featuresArray[e-1]},s=function(e){$.each(a.featuresArray,function(){return $(this).data().setPosition==e?$(this):void 0})},l=function(e){return e-1==0?a.totalFeatureCount:e-1},o=function(e){return e+1>a.totalFeatureCount?1:e+1},d=function(){a.containerWidth=a.featuresContainer.width(),1==e.trackerIndividual||1==e.trackerSummation?a.containerHeight=a.sliderMaxHeight*(a.containerWidth/a.sliderMaxWidth)+20:a.containerHeight=a.sliderMaxHeight*(a.containerWidth/a.sliderMaxWidth),$(a.containerIDTag).css("height",a.containerHeight);var t=$(a.containerIDTag).find(".carousel-image:first");e.largeFeatureWidth>1?a.largeFeatureWidth=e.largeFeatureWidth:e.largeFeatureWidth>0&&e.largeFeatureWidth<=1?a.largeFeatureWidth=t.width()*e.largeFeatureWidth:a.largeFeatureWidth=t.outerWidth(),e.largeFeatureHeight>1?a.largeFeatureHeight=e.largeFeatureHeight:e.largeFeatureHeight>0&&e.largeFeatureHeight<=1?a.largeFeatureHeight=t.height()*e.largeFeatureHeight:a.largeFeatureHeight=t.outerHeight(),e.smallFeatureWidth>1?a.smallFeatureWidth=e.smallFeatureWidth:e.smallFeatureWidth>0&&e.smallFeatureWidth<=1?a.smallFeatureWidth=t.width()*e.smallFeatureWidth:a.smallFeatureWidth=t.outerWidth()/2,e.smallFeatureHeight>1?a.smallFeatureHeight=e.smallFeatureHeight:e.smallFeatureHeight>0&&e.smallFeatureHeight<=1?a.smallFeatureHeight=t.height()*e.smallFeatureHeight:a.smallFeatureHeight=t.outerHeight()/2},u=function(){e.displayCutoff>0&&e.displayCutoff<a.totalFeatureCount&&(a.totalFeatureCount=e.displayCutoff),a.featuresContainer.find(".carousel-feature").each(function(e){e<a.totalFeatureCount&&(a.featuresArray[e]=$(this))}),"medium"!=a.featuresContainer.find(".carousel-feature").first().css("borderLeftWidth")&&(a.borderWidth=2*parseInt(a.featuresContainer.find(".carousel-feature").first().css("borderLeftWidth")),a.borderWidth=a.borderWidth+2*parseInt(a.featuresContainer.find(".carousel-feature").first().css("paddingLeft")));var t=a.containerWidth/a.sliderMaxWidth;a.featuresContainer.find(".carousel-feature").each(function(){$(this).css({left:a.containerWidth/2-a.smallFeatureWidth/2-a.borderWidth/2,width:a.smallFeatureWidth*t,height:a.smallFeatureHeight*t,top:e.smallFeatureOffset+e.topPadding,opacity:0})}).find(".carousel-image").css({width:a.smallFeatureWidth*t}),e.captionBelow&&a.featuresContainer.find(".carousel-caption").css("position","relative"),a.totalFeatureCount<4?a.itemsToAnimate=a.totalFeatureCount:a.itemsToAnimate=4,a.featuresContainer.find(".carousel-caption").hide();var i=jQuery(a.containerIDTag).find(".pinwheel_eshortcode iframe").not(":eq(0)");i.length>0&&jQuery(i).each(function(e,t){var i,a;i=jQuery(this)[0].outerHTML.replace(/<iframe/,"<div class='pinwheel-iframe'").replace("</iframe>","</div>"),a=jQuery(t).parent(),jQuery(t).remove(),a.html(i)})},c=function(){$.each(a.featuresArray,function(e){$(this).data("setPosition",e+1)});var t=l(e.startingFeature);a.currentCenterNum=t;var i=r(t);i.data("position",1);var n=i.prevAll();n.each(function(e){$(this).data("position",a.totalFeatureCount-e)});var s=i.nextAll();s.each(function(e){void 0!=$(this).data("setPosition")&&$(this).data("position",e+2)}),"caption"==e.counterStyle&&$.each(a.featuresArray,function(){var e=l($(this).data("position")),t=$("<span></span>");t.addClass("numberTag"),t.html("("+e+" of "+a.totalFeatureCount+") "),$(this).find(".carousel-caption p").prepend(t)})},h=function(){if(e.trackerIndividual){var t=$("<ul></ul>");t.addClass("tracker-individual-container");for(var i=0;i<a.totalFeatureCount;i++){var n=i+1,r=$("<div>"+n+"</div>");r.addClass("tracker-individual-blip"),r.addClass("tracker-"+(i+1)),r.css("cursor","pointer");var s=$("<li></li>");s.append(r),s.css("float","left"),s.css("list-style-type","none"),t.append(s)}$(a.containerIDTag).append(t),t.hide().show()}if(e.trackerSummation){var l=$("<div></div>");l.addClass("tracker-summation-container");var o=$("<span></span>").addClass("tracker-summation-current").text(e.startingFeature),d=$("<span></span>").addClass("tracker-summation-total").text(a.totalFeatureCount),u=$("<span></span>").addClass("tracker-summation-middle").text(" of ");l.append(o).append(u).append(d),$(a.containerIDTag).append(l)}},f=function(t,i){if(e.trackerIndividual){var n=a.featuresContainer.find(".tracker-individual-container"),r=n.find(".tracker-"+t),s=n.find(".tracker-"+i);r.removeClass("tracker-individual-blip-selected"),s.addClass("tracker-individual-blip-selected")}if(e.trackerSummation){var n=a.featuresContainer.find(".tracker-summation-container");n.find(".tracker-summation-current").text(i)}},p=function(t){if(clearTimeout(a.timeoutVar),!t&&0!=e.autoPlay){var i=Math.abs(e.autoPlay)<e.carouselSpeed?e.carouselSpeed:Math.abs(e.autoPlay);a.timeoutVar=setTimeout(function(){e.autoPlay>0?C(!0,1):C(!1,1)},i)}},m=function(e){$.each(a.featuresArray,function(){var t;t=0==e?o($(this).data().position):l($(this).data().position),$(this).data("position",t)})},g=function(t,i){var n,r,s,d,u,c,h,g=t.data("position"),C;C=1==i?l(g):o(g),1==g&&e.leavingCenter(t),1==C?(n=a.largeFeatureWidth*(a.containerWidth/a.sliderMaxWidth),r=a.largeFeatureHeight*(a.containerWidth/a.sliderMaxWidth),s=e.topPadding,u=t.css("z-index"),d=a.containerWidth/2-n/2-a.borderWidth/2,h=1):(n=a.smallFeatureWidth*(a.containerWidth/a.sliderMaxWidth),r=a.smallFeatureHeight*(a.containerWidth/a.sliderMaxWidth),s=e.smallFeatureOffset*(a.containerWidth/a.sliderMaxWidth)+e.topPadding,u=1,h=.75,C==a.totalFeatureCount?d=e.sidePadding:2==C?d=a.containerWidth-n-e.sidePadding-a.borderWidth:(d=a.containerWidth/2-n/2-a.borderWidth/2,h=0)),1==g&&t.find(".carousel-caption").stop(!0,!0).slideUp(0),0>d&&(d=0),t.animate({width:n,height:r,top:s,left:d,opacity:h},e.carouselSpeed,e.animationEasing,function(){if(1==C&&(e.captionBelow&&t.css("height","auto"),0==e.minimize?(t.find(".carousel-caption").slideDown(400),jQuery(a.containerIDTag).find(".pinwheel_center_slide .carousel-caption .texthide").css("display","block")):(jQuery(a.containerIDTag).find(".pinwheel_center_slide .carousel-caption").css("display","none"),jQuery(a.containerIDTag).find(".pinwheel_center_slide .textshow").css("display","block")),jQuery(a.containerIDTag).find(".pinwheel_center_slide .carousel-caption .texthide").bind("click",function(){jQuery(a.containerIDTag).find(".pinwheel_center_slide .carousel-caption").slideUp("slow"),jQuery(a.containerIDTag).find(".pinwheel_center_slide .textshow").css("display","block")}),jQuery(a.containerIDTag).find(".pinwheel_center_slide .textshow").bind("click",function(){jQuery(a.containerIDTag).find(".pinwheel_center_slide .carousel-caption").stop(!0,!0).slideUp(0),jQuery(a.containerIDTag).find(".pinwheel_center_slide .carousel-caption").slideDown(400),jQuery(a.containerIDTag).find(".pinwheel_center_slide .carousel-caption .texthide").css("display","block"),$(this).hide()}),jQuery(a.containerIDTag).find(".pinwheel_right_slide .textshow").css({display:"none"}),jQuery(a.containerIDTag).find(".pinwheel_left_slide .textshow").css({display:"none"}),e.movedToCenter(t)),a.rotationsRemaining=a.rotationsRemaining-1,t.css("z-index",u),(e.trackerIndividual||e.trackerSummation)&&1==C){var n=a.featuresContainer.find(".carousel-feature").index(t)+1,r;r=0==i?o(n):l(n),f(r,n)}var s=a.rotationsRemaining/a.itemsToAnimate;s%1==0&&(a.currentlyMoving=!1,m(i),a.rotationsRemaining>0&&v(i)),p(!1)}).find(".carousel-image").animate({width:n,height:r},e.carouselSpeed,e.animationEasing).find(".carousel-image").animate({width:n,height:r},e.carouselSpeed,e.animationEasing).end()},v=function(t){a.currentlyMoving=!0;var i,n,s,d;1==t?(i=r(o(a.currentCenterNum)),n=r(a.currentCenterNum),a.prevCenterNum=a.currentCenterNum,s=r(o(o(a.currentCenterNum))),d=r(l(a.currentCenterNum)),a.currentCenterNum=o(a.currentCenterNum)):(i=r(l(a.currentCenterNum)),n=r(l(l(a.currentCenterNum))),a.prevCenterNum=a.currentCenterNum,s=r(a.currentCenterNum),d=r(o(a.currentCenterNum)),a.currentCenterNum=l(a.currentCenterNum)),t?n.css("z-index",3):s.css("z-index",3),i.css("z-index",4);var u=r(a.prevCenterNum),c=u.find(".pinwheel_eshortcode .pinwheel-iframe").eq(0);if(c.length<=0&&(c=u.find(".pinwheel_eshortcode iframe").eq(0)),c.length>0){var h,f;h=jQuery(c)[0].outerHTML.replace(/<iframe/,"<div class='pinwheel-iframe'").replace("</iframe>","</div>"),f=jQuery(c).parent(),jQuery(c).remove(),f.html(h)}i.removeClass("pinwheel_left_slide pinwheel_right_slide pinwheel_feature_slide"),i.addClass("pinwheel_center_slide");var p=i.find(".pinwheel_slider_thumbnail").data("anim"),m=i.find(".pinwheel_text span").data("anim"),v=i.find(".slider_htitle").data("anim");i.find(".pinwheel_slider_thumbnail").removeClass("pinwheel-animated"),i.find(".pinwheel_slider_thumbnail").removeClass("pinwheel-"+p),i.find(".pinwheel_text span").removeClass("pinwheel-animated"),i.find(".pinwheel_text span").removeClass("pinwheel-"+m),i.find(".slider_htitle").removeClass("pinwheel-animated"),i.find(".slider_htitle").removeClass("pinwheel-"+v),n.removeClass("pinwheel_center_slide pinwheel_hidden_slide"),n.addClass("pinwheel_left_slide pinwheel_feature_slide"),s.removeClass("pinwheel_center_slide pinwheel_hidden_slide"),s.addClass("pinwheel_right_slide pinwheel_feature_slide"),d.removeClass("pinwheel_left_slide pinwheel_right_slide"),d.addClass("pinwheel_hidden_slide"),e.movingToCenter(i),g(n,t),g(i,t),g(s,t),a.totalFeatureCount>3&&g(d,t),i.find(".pinwheel_slider_thumbnail").addClass("pinwheel-animated"),i.find(".pinwheel_slider_thumbnail").addClass("pinwheel-"+p),i.find(".pinwheel_text span").addClass("pinwheel-animated"),i.find(".pinwheel_text span").addClass("pinwheel-"+m),i.find(".slider_htitle").addClass("pinwheel-animated"),i.find(".slider_htitle").addClass("pinwheel-"+v),setTimeout(function(){c=i.find(".pinwheel_eshortcode .pinwheel-iframe").eq(0),c.length<=0&&(c=u.find(".pinwheel_eshortcode iframe").eq(0)),c.length>0&&(ifrmdivHtml=c[0].outerHTML.replace(/<div class="pinwheel-iframe"/,"<iframe").replace("</div>","</iframe>"),f=c.parent(),c.remove(),f.html(ifrmdivHtml))},e.carouselSpeed)},C=function(e,t){if(0==a.currentlyMoving){var i=t*a.itemsToAnimate;a.rotationsRemaining=i,v(e)}},w=function(e,t){var i=1,a=1,n;for(n=e;(n=l(n))!=t;)i++;for(n=e;(n=o(n))!=t;)a++;return a>i?-1*i:a};return $(e.leftButtonTag).on("click",function(){C(!1,1)}),$(e.rightButtonTag).on("click",function(){C(!0,1)}),a.featuresContainer.find(".carousel-feature").click(function(){var e=$(this).data("position");2==e?C(!0,1):e==a.totalFeatureCount&&C(!1,1)}).mouseover(function(){if(0==a.currentlyMoving){var t=$(this).data("position");(2==t||t==a.totalFeatureCount)&&$(this).css("opacity",.9)}e.pauseOnHover&&p(!0),e.stopOnHover&&(e.autoPlay=0)}).mouseout(function(){if(0==a.currentlyMoving){var t=$(this).data("position");(2==t||t==a.totalFeatureCount)&&$(this).css("opacity",.75)}e.pauseOnHover&&p(!1)}),$("a",a.containerIDTag).on("click",function(t){var i=$(this).parentsUntil(a.containerIDTag);i.each(function(){var i=$(this).data("position");if(void 0!=i){if(1!=i)return i==a.totalFeatureCount?C(!1,1):2==i&&C(!0,1),t.preventDefault(),!1;e.clickedCenter($(this))}})}),$(document).on("click",a.containerIDTag+" .tracker-individual-blip",function(){var e=$(this).html(),t=a.featuresContainer.find(".carousel-feature").eq(e-1).data("position"),i=a.currentCenterNum;if(e!=i){var n=w(1,t);0>n?C(!1,-1*n):C(!0,n)}}),this.reload=function(t){if(console.log(t),jQuery(a.containerIDTag).find(".carousel-feature .carousel-caption").css({display:"none"}),"object"==typeof t)var i=t;else var i={};e=$.extend({},$.fn.pinwheel.defaults,i),n(function(){d(),u(),c(),h(),C(!0,1)})},this.next=function(){C(!0,1)},this.prev=function(){C(!1,1)},this.pause=function(){p(!0)},this.start=function(){p(!1)},this.reload(e),this},$.fn.pinwheel.defaults={largeFeatureWidth:0,largeFeatureHeight:0,smallFeatureWidth:.5,smallFeatureHeight:.5,topPadding:20,sidePadding:50,smallFeatureOffset:50,startingFeature:1,carouselSpeed:1e3,autoPlay:4e3,pauseOnHover:!0,stopOnHover:!1,trackerIndividual:!0,trackerSummation:!0,preload:!0,displayCutoff:0,animationEasing:"swing",leftButtonTag:"#carousel-left",rightButtonTag:"#carousel-right",captionBelow:!1,movedToCenter:$.noop,leavingCenter:$.noop,clickedCenter:$.noop,movingToCenter:$.noop,sliderMaxWidth:900,sliderMaxHeight:350}}(jQuery);