!function(e){var t,i,a=jQuery.event;t=a.special.debouncedresize={setup:function(){jQuery(this).on("resize",t.handler)},teardown:function(){jQuery(this).off("resize",t.handler)},handler:function(e,n){var r=this,s=arguments,l=function(){e.type="debouncedresize",a.dispatch.apply(r,s)};i&&clearTimeout(i),n?l():i=setTimeout(l,t.threshold)},threshold:50},e.fn.pinwheel=function(t){if(this.length>1)return this.each(function(){e(this).pinwheel(t)}),this;t=e.extend({},e.fn.pinwheel.defaults,t||{});var i,a;i=0===t.sliderMaxWidth?e(this).width():t.sliderMaxWidth,a=0===t.sliderMaxHeight?e(this).height():t.sliderMaxHeight;var n={currentCenterNum:t.startingFeature,prevCenterNum:-1,containerWidth:0,containerHeight:0,largeFeatureWidth:0,largeFeatureHeight:0,smallFeatureWidth:0,smallFeatureHeight:0,totalFeatureCount:e(this).children("div").length,allItems:e(this).children("div"),currentlyMoving:!1,featuresContainer:e(this),featuresArray:[],containerIDTag:"#"+e(this).attr("id"),timeoutVar:null,rotationsRemaining:0,itemsToAnimate:0,borderWidth:0,sliderMaxWidth:i,sliderMaxHeight:a},r=function(i){if(t.preload===!0){var a=n.featuresContainer.find("img"),r=0,s=a.length;a.each(function(t,a){var n=new Image;e(n).bind("load error",function(){r++,r==s&&i()}),n.src=a.src})}else i()},s=function(e){return n.featuresArray[e-1]},l=function(e){return e-1===0?n.totalFeatureCount:e-1},o=function(e){return e+1>n.totalFeatureCount?1:e+1},d=function(){n.containerWidth=n.featuresContainer.width(),t.trackerIndividual===!0||t.trackerSummation===!0?n.containerHeight=n.sliderMaxHeight*(n.containerWidth/n.sliderMaxWidth)+20:n.containerHeight=n.sliderMaxHeight*(n.containerWidth/n.sliderMaxWidth),e(n.containerIDTag).css("height",n.containerHeight);var i=e(n.containerIDTag).find(".carousel-image:first");t.largeFeatureWidth>1?n.largeFeatureWidth=t.largeFeatureWidth:t.largeFeatureWidth>0&&t.largeFeatureWidth<=1?n.largeFeatureWidth=i.width()*t.largeFeatureWidth:n.largeFeatureWidth=i.outerWidth(),t.largeFeatureHeight>1?n.largeFeatureHeight=t.largeFeatureHeight:t.largeFeatureHeight>0&&t.largeFeatureHeight<=1?n.largeFeatureHeight=i.height()*t.largeFeatureHeight:n.largeFeatureHeight=i.outerHeight(),t.smallFeatureWidth>1?n.smallFeatureWidth=t.smallFeatureWidth:t.smallFeatureWidth>0&&t.smallFeatureWidth<=1?n.smallFeatureWidth=i.width()*t.smallFeatureWidth:n.smallFeatureWidth=i.outerWidth()/2,t.smallFeatureHeight>1?n.smallFeatureHeight=t.smallFeatureHeight:t.smallFeatureHeight>0&&t.smallFeatureHeight<=1?n.smallFeatureHeight=i.height()*t.smallFeatureHeight:n.smallFeatureHeight=i.outerHeight()/2},u=function(){t.displayCutoff>0&&t.displayCutoff<n.totalFeatureCount&&(n.totalFeatureCount=t.displayCutoff),n.featuresContainer.find(".carousel-feature").each(function(t){t<n.totalFeatureCount&&(n.featuresArray[t]=e(this))}),"medium"!=n.featuresContainer.find(".carousel-feature").first().css("borderLeftWidth")&&(n.borderWidth=2*parseInt(n.featuresContainer.find(".carousel-feature").first().css("borderLeftWidth")),n.borderWidth=n.borderWidth+2*parseInt(n.featuresContainer.find(".carousel-feature").first().css("paddingLeft")));var i=n.containerWidth/n.sliderMaxWidth;n.featuresContainer.find(".carousel-feature").each(function(){e(this).css({left:n.containerWidth/2-n.smallFeatureWidth/2-n.borderWidth/2,width:n.smallFeatureWidth*i,height:n.smallFeatureHeight*i,top:t.smallFeatureOffset+t.topPadding,opacity:0})}).find(".carousel-image").css({width:n.smallFeatureWidth*i}),t.captionBelow&&n.featuresContainer.find(".carousel-caption").css("position","relative"),n.totalFeatureCount<4?n.itemsToAnimate=n.totalFeatureCount:n.itemsToAnimate=4,n.featuresContainer.find(".carousel-caption").hide();var a=jQuery(n.containerIDTag).find(".pinwheel_eshortcode iframe").not(":eq(0)");a.length>0&&jQuery(a).each(function(e,t){var i,a;i=jQuery(this)[0].outerHTML.replace(/<iframe/,"<div class='pinwheel-iframe'").replace("</iframe>","</div>"),a=jQuery(t).parent(),jQuery(t).remove(),a.html(i)})},c=function(){e.each(n.featuresArray,function(t){e(this).data("setPosition",t+1)});var i=l(t.startingFeature);n.currentCenterNum=i;var a=s(i);a.data("position",1);var r=a.prevAll();r.each(function(t){e(this).data("position",n.totalFeatureCount-t)});var o=a.nextAll();o.each(function(t){void 0!==e(this).data("setPosition")&&e(this).data("position",t+2)}),"caption"==t.counterStyle&&e.each(n.featuresArray,function(){var t=l(e(this).data("position")),i=e("<span></span>");i.addClass("numberTag"),i.html("("+t+" of "+n.totalFeatureCount+") "),e(this).find(".carousel-caption p").prepend(i)})},h=function(){if(t.trackerIndividual){var i=e("<ul></ul>");i.addClass("tracker-individual-container");for(var a=0;a<n.totalFeatureCount;a++){var r=a+1,s=e("<div>"+r+"</div>");s.addClass("tracker-individual-blip"),s.addClass("tracker-"+(a+1)),s.css("cursor","pointer");var l=e("<li></li>");l.append(s),l.css("float","left"),l.css("list-style-type","none"),i.append(l)}e(n.containerIDTag).append(i),i.hide().show()}if(t.trackerSummation){var o=e("<div></div>");o.addClass("tracker-summation-container");var d=e("<span></span>").addClass("tracker-summation-current").text(t.startingFeature),u=e("<span></span>").addClass("tracker-summation-total").text(n.totalFeatureCount),c=e("<span></span>").addClass("tracker-summation-middle").text(" of ");o.append(d).append(c).append(u),e(n.containerIDTag).append(o)}},f=function(e,i){if(t.trackerIndividual){var a=n.featuresContainer.find(".tracker-individual-container"),r=a.find(".tracker-"+e),s=a.find(".tracker-"+i);r.removeClass("tracker-individual-blip-selected"),s.addClass("tracker-individual-blip-selected")}if(t.trackerSummation){var a=n.featuresContainer.find(".tracker-summation-container");a.find(".tracker-summation-current").text(i)}},p=function(e){if(clearTimeout(n.timeoutVar),!e&&0!==t.autoPlay){var i=Math.abs(t.autoPlay)<t.carouselSpeed?t.carouselSpeed:Math.abs(t.autoPlay);n.timeoutVar=setTimeout(function(){t.autoPlay>0?C(!0,1):C(!1,1)},i)}},m=function(t){e.each(n.featuresArray,function(){var i;i=t===!1?o(e(this).data().position):l(e(this).data().position),e(this).data("position",i)})},g=function(i,a){var r,s,d,u,c,h,g,C=i.data("position");g=a===!0?l(C):o(C),1==C&&t.leavingCenter(i),1==g?(r=n.largeFeatureWidth*(n.containerWidth/n.sliderMaxWidth),s=n.largeFeatureHeight*(n.containerWidth/n.sliderMaxWidth),d=t.topPadding,c=i.css("z-index"),u=n.containerWidth/2-r/2-n.borderWidth/2,h=1):(r=n.smallFeatureWidth*(n.containerWidth/n.sliderMaxWidth),s=n.smallFeatureHeight*(n.containerWidth/n.sliderMaxWidth),d=t.smallFeatureOffset*(n.containerWidth/n.sliderMaxWidth)+t.topPadding,c=1,h=.75,g==n.totalFeatureCount?u=t.sidePadding:2==g?u=n.containerWidth-r-t.sidePadding-n.borderWidth:(u=n.containerWidth/2-r/2-n.borderWidth/2,h=0)),1==C&&i.find(".carousel-caption").stop(!0,!0).slideUp(0),0>u&&(u=0),i.animate({width:r,height:s,top:d,left:u,opacity:h},t.carouselSpeed,t.animationEasing,function(){if(1==g&&(t.captionBelow&&i.css("height","auto"),t.minimize===!1?(i.find(".carousel-caption").slideDown(400),jQuery(n.containerIDTag).find(".pinwheel_center_slide .carousel-caption .texthide").css("display","block")):(jQuery(n.containerIDTag).find(".pinwheel_center_slide .carousel-caption").css("display","none"),jQuery(n.containerIDTag).find(".pinwheel_center_slide .textshow").css("display","block")),jQuery(n.containerIDTag).find(".pinwheel_center_slide .carousel-caption .texthide").bind("click",function(){jQuery(n.containerIDTag).find(".pinwheel_center_slide .carousel-caption").slideUp("slow"),jQuery(n.containerIDTag).find(".pinwheel_center_slide .textshow").css("display","block")}),jQuery(n.containerIDTag).find(".pinwheel_center_slide .textshow").bind("click",function(){jQuery(n.containerIDTag).find(".pinwheel_center_slide .carousel-caption").stop(!0,!0).slideUp(0),jQuery(n.containerIDTag).find(".pinwheel_center_slide .carousel-caption").slideDown(400),jQuery(n.containerIDTag).find(".pinwheel_center_slide .carousel-caption .texthide").css("display","block"),e(this).hide()}),jQuery(n.containerIDTag).find(".pinwheel_right_slide .textshow").css({display:"none"}),jQuery(n.containerIDTag).find(".pinwheel_left_slide .textshow").css({display:"none"}),t.movedToCenter(i)),n.rotationsRemaining=n.rotationsRemaining-1,i.css("z-index",c),(t.trackerIndividual||t.trackerSummation)&&1==g){var r,s=n.featuresContainer.find(".carousel-feature").index(i)+1;r=a===!1?o(s):l(s),f(r,s)}var d=n.rotationsRemaining/n.itemsToAnimate;d%1===0&&(n.currentlyMoving=!1,m(a),n.rotationsRemaining>0&&v(a)),p(!1)}).find(".carousel-image").animate({width:r,height:s},t.carouselSpeed,t.animationEasing).find(".carousel-image").animate({width:r,height:s},t.carouselSpeed,t.animationEasing).end()},v=function(e){n.currentlyMoving=!0;var i,a,r,d;e===!0?(i=s(o(n.currentCenterNum)),a=s(n.currentCenterNum),n.prevCenterNum=n.currentCenterNum,r=s(o(o(n.currentCenterNum))),d=s(l(n.currentCenterNum)),n.currentCenterNum=o(n.currentCenterNum)):(i=s(l(n.currentCenterNum)),a=s(l(l(n.currentCenterNum))),n.prevCenterNum=n.currentCenterNum,r=s(n.currentCenterNum),d=s(o(n.currentCenterNum)),n.currentCenterNum=l(n.currentCenterNum)),e?a.css("z-index",3):r.css("z-index",3),i.css("z-index",4);var u=s(n.prevCenterNum),c=u.find(".pinwheel_eshortcode .pinwheel-iframe").eq(0);if(c.length<=0&&(c=u.find(".pinwheel_eshortcode iframe").eq(0)),c.length>0){var h,f;h=jQuery(c)[0].outerHTML.replace(/<iframe/,"<div class='pinwheel-iframe'").replace("</iframe>","</div>"),f=jQuery(c).parent(),jQuery(c).remove(),f.html(h)}i.removeClass("pinwheel_left_slide pinwheel_right_slide pinwheel_feature_slide"),i.addClass("pinwheel_center_slide");var p=i.find(".pinwheel_slider_thumbnail").data("anim"),m=i.find(".pinwheel_text span").data("anim"),v=i.find(".slider_htitle").data("anim");i.find(".pinwheel_slider_thumbnail").removeClass("pinwheel-animated"),i.find(".pinwheel_slider_thumbnail").removeClass("pinwheel-"+p),i.find(".pinwheel_text span").removeClass("pinwheel-animated"),i.find(".pinwheel_text span").removeClass("pinwheel-"+m),i.find(".slider_htitle").removeClass("pinwheel-animated"),i.find(".slider_htitle").removeClass("pinwheel-"+v),a.removeClass("pinwheel_center_slide pinwheel_hidden_slide"),a.addClass("pinwheel_left_slide pinwheel_feature_slide"),r.removeClass("pinwheel_center_slide pinwheel_hidden_slide"),r.addClass("pinwheel_right_slide pinwheel_feature_slide"),d.removeClass("pinwheel_left_slide pinwheel_right_slide"),d.addClass("pinwheel_hidden_slide"),t.movingToCenter(i),g(a,e),g(i,e),g(r,e),n.totalFeatureCount>3&&g(d,e),i.find(".pinwheel_slider_thumbnail").addClass("pinwheel-animated"),i.find(".pinwheel_slider_thumbnail").addClass("pinwheel-"+p),i.find(".pinwheel_text span").addClass("pinwheel-animated"),i.find(".pinwheel_text span").addClass("pinwheel-"+m),i.find(".slider_htitle").addClass("pinwheel-animated"),i.find(".slider_htitle").addClass("pinwheel-"+v),setTimeout(function(){c=i.find(".pinwheel_eshortcode .pinwheel-iframe").eq(0),c.length<=0&&(c=u.find(".pinwheel_eshortcode iframe").eq(0)),c.length>0&&(ifrmdivHtml=c[0].outerHTML.replace(/<div class="pinwheel-iframe"/,"<iframe").replace("</div>","</iframe>"),f=c.parent(),c.remove(),f.html(ifrmdivHtml))},t.carouselSpeed)},C=function(e,t){if(n.currentlyMoving===!1){var i=t*n.itemsToAnimate;n.rotationsRemaining=i,v(e)}},w=function(e,t){var i,a=1,n=1;for(i=e;(i=l(i))!=t;)a++;for(i=e;(i=o(i))!=t;)n++;return n>a?-1*a:n};return e(t.leftButtonTag).on("click",function(){C(!1,1)}),e(t.rightButtonTag).on("click",function(){C(!0,1)}),n.featuresContainer.find(".carousel-feature").click(function(){var t=e(this).data("position");2==t?C(!0,1):t==n.totalFeatureCount&&C(!1,1)}).mouseover(function(){if(n.currentlyMoving===!1){var i=e(this).data("position");(2==i||i==n.totalFeatureCount)&&e(this).css("opacity",.9)}t.pauseOnHover&&p(!0),t.stopOnHover&&(t.autoPlay=0)}).mouseout(function(){if(n.currentlyMoving===!1){var i=e(this).data("position");(2==i||i==n.totalFeatureCount)&&e(this).css("opacity",.75)}t.pauseOnHover&&p(!1)}),e("a",n.containerIDTag).on("click",function(i){var a=e(this).parentsUntil(n.containerIDTag);a.each(function(){var a=e(this).data("position");if(void 0!==a){if(1!=a)return a==n.totalFeatureCount?C(!1,1):2==a&&C(!0,1),i.preventDefault(),!1;t.clickedCenter(e(this))}})}),e(document).on("click",n.containerIDTag+" .tracker-individual-blip",function(){var t=e(this).html(),i=n.featuresContainer.find(".carousel-feature").eq(t-1).data("position"),a=n.currentCenterNum;if(t!=a){var r=w(1,i);0>r?C(!1,-1*r):C(!0,r)}}),this.reload=function(i){if(console.log(i),jQuery(n.containerIDTag).find(".carousel-feature .carousel-caption").css({display:"none"}),"object"==typeof i)var a=i;else var a={};t=e.extend({},e.fn.pinwheel.defaults,a),r(function(){d(),u(),c(),h(),C(!0,1)})},this.next=function(){C(!0,1)},this.prev=function(){C(!1,1)},this.pause=function(){p(!0)},this.start=function(){p(!1)},this.reload(t),this},e.fn.pinwheel.defaults={largeFeatureWidth:0,largeFeatureHeight:0,smallFeatureWidth:.5,smallFeatureHeight:.5,topPadding:20,sidePadding:50,smallFeatureOffset:50,startingFeature:1,carouselSpeed:1e3,autoPlay:4e3,pauseOnHover:!0,stopOnHover:!1,trackerIndividual:!0,trackerSummation:!0,preload:!0,displayCutoff:0,animationEasing:"swing",leftButtonTag:"#carousel-left",rightButtonTag:"#carousel-right",captionBelow:!1,movedToCenter:e.noop,leavingCenter:e.noop,clickedCenter:e.noop,movingToCenter:e.noop,sliderMaxWidth:900,sliderMaxHeight:350}}(jQuery);